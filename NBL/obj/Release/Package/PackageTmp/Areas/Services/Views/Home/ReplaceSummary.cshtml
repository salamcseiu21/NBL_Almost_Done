@model IEnumerable<NBL.Models.ViewModels.Replaces.ViewReplaceSummary>
@{
    ViewBag.Title = "Replace Summary";
    Layout = "~/Views/Shared/_UserLayoutPage.cshtml";
    var i = 0;
}


<div class="panel panel-info">
    <div class="panel panel-heading" style="font-size: 22px;font-weight: bolder">Total Replace Summary</div>
    <div class="panel panel-body">
        <table class="display table-bordered table-responsive" id="tbl_replace_list" style="border: 1px solid; width: 100%">
            <thead>
                <tr>
                    <th>S.N</th>
                    <th>Product Name</th>
                    <th>Segment</th>
                    <th class="text-right">Replace Quantity</th>
                </tr>
            </thead>
            @foreach (var item in Model)
            {
                i++;
                <tr>
                    <td>@i</td>
                    <td>@item.ProductName</td>
                    <td>@item.ProductCategoryName</td>
                    <td class="text-right">@item.Quantity</td>
                </tr>
            }
            <tfoot>
                <tr>

                    <th colspan="3" class="text-right">Total</th>
                    <th class="text-right">@Model.Sum(n => n.Quantity)</th>
                </tr>
                <tr>
                    <th>S.N</th>
                    <th>Product Name</th>
                    <th>Segment</th>
                    <th class="text-right">Replace Quantity</th>
                </tr>
            </tfoot>
        </table>
    </div>
</div>

@section Scripts
{
    <script>
        $("#tbl_replace_list").DataTable({
            "lengthMenu": [[10, 20, 30, -1], [10, 20, 30, "All"]],
            dom: 'Bfrtip',
            buttons: [
                {
                    extend: 'excel',
                    text: 'Download as Excel',
                    title: 'Replace List',
                    exportOptions: {
                        columns: [0, 1, 2,3]
                    }
                },
                {
                    extend: 'print',
                    text: 'Print',
                    exportOptions: {
                        columns: [0, 1, 2,3]
                    },
                    title: 'Replace List',
                    customize: function (win) {
                        $(win.document.body)
                            .css('font-size', '10pt');

                        $(win.document.body).find('table')
                            .addClass('compact')
                            .css('font-size', 'inherit');
                    }
                }
            ]
        });
    </script>
}

